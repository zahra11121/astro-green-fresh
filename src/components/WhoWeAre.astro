---
/**
 * WHO WE ARE COMPONENT - ASTRO VERSION
 * Perbaikan: Menangani issue "blank putih" dengan CSS Fallback & Robust Observer.
 */
import { Users, Factory, ShieldCheck, ArrowRight } from 'lucide-react';
import productsData from '@/data/products.json'; 

const { id = "who-we-are" } = Astro.props;

const ABOUT_IMAGE_SOURCE = productsData.find(p => p.name === "Wortel")?.image || productsData[0]?.image;
---

<section id={id} class="py-12 lg:py-24 bg-white overflow-hidden font-sans border-b-2 border-green-100 text-left reveal-container">
  <div class="max-w-[1800px] mx-auto px-6 md:px-12 lg:px-20">
    
    <div class="grid lg:grid-cols-12 gap-12 lg:gap-24 items-center">
      
      <div class="lg:col-span-5 relative">
        <div class="relative rounded-[3rem] lg:rounded-[4rem] overflow-hidden border-2 border-green-100 shadow-2xl aspect-[4/5] bg-slate-100 group reveal-left">
          <img 
            src={ABOUT_IMAGE_SOURCE} 
            alt="Produk Unggulan Green Fresh Cipanas" 
            class="w-full h-full object-cover grayscale-[0.1] group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-105"
            loading="lazy"
            decoding="async"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-green-900/60 via-transparent to-transparent opacity-60" aria-hidden="true"></div>
          
          <div class="absolute bottom-8 left-8 right-8 bg-white/95 backdrop-blur-md border-2 border-green-100 p-6 rounded-[2rem] shadow-xl reveal-up" style="transition-delay: 0.4s;">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-2xl bg-green-50 flex items-center justify-center text-[#15803d]">
                <Factory size={22} />
              </div>
              <div>
                <p class="text-[#15803d] text-[9px] font-black uppercase tracking-[0.3em] leading-none mb-1">Main Hub</p>
                <p class="text-[#052c17] text-lg font-serif italic font-black uppercase leading-none">Cipanas Agribusiness</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="lg:col-span-7 space-y-10">
        <div class="space-y-6">
          <div class="inline-flex items-center gap-3 px-4 py-2 bg-[#f7faf7] rounded-full border-2 border-green-100 reveal-up">
            <span class="w-2 h-2 rounded-full bg-[#16a34a] animate-pulse"></span>
            <span class="text-[10px] font-black uppercase tracking-[0.3em] text-[#15803d]">Verified Supplier Profile</span>
          </div>
          
          <h2 class="text-4xl md:text-6xl lg:text-7xl font-serif italic font-black text-[#052c17] leading-[1] tracking-tighter uppercase reveal-up" style="transition-delay: 0.1s;">
            Distributor <span class="text-[#15803d] not-italic font-sans">Sayuran Profesional</span>
          </h2>
          
          <p class="text-lg lg:text-2xl text-slate-600 font-medium leading-relaxed max-w-2xl border-l-4 border-green-500/30 pl-6 lg:pl-10 reveal-up" style="transition-delay: 0.2s;">
            <span class="text-[#052c17] font-bold italic">Green Fresh Cipanas</span> adalah supplier tangan pertama yang hadir sebagai mitra strategis pengadaan sayur hotel, restoran, dan supermarket melalui integrasi petani lokal berkualitas super.
          </p>
        </div>

        <div class="grid sm:grid-cols-2 gap-8 border-t-2 border-green-50 pt-8">
          <div class="space-y-3 reveal-up" style="transition-delay: 0.3s;">
            <div class="flex items-center gap-3 text-[#15803d]">
              <Users size={18} />
              <span class="text-[10px] font-black uppercase tracking-widest">Highland Sourcing</span>
            </div>
            <p class="text-slate-700 text-sm leading-relaxed font-semibold">
              Bermitra dengan 200+ petani dataran tinggi untuk menjamin kontinuitas panen setiap hari tanpa jeda.
            </p>
          </div>

          <div class="space-y-3 reveal-up" style="transition-delay: 0.4s;">
            <div class="flex items-center gap-3 text-[#15803d]">
              <ShieldCheck size={18} />
              <span class="text-[10px] font-black uppercase tracking-widest">Quality Assurance</span>
            </div>
            <p class="text-slate-700 text-sm leading-relaxed font-semibold">
              Proses seleksi ketat (Sorting & Grading) untuk memastikan standar Grade-A sesuai kebutuhan industri Horeka.
            </p>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row items-center gap-8 pt-4 reveal-up" style="transition-delay: 0.5s;">
          <a href="/about" class="w-full sm:w-auto">
            <button class="group w-full flex items-center justify-center gap-4 bg-[#052c17] text-[#bef264] px-10 py-5 rounded-2xl font-black text-xs uppercase tracking-[0.2em] hover:bg-[#15803d] hover:text-white transition-all shadow-2xl active:scale-95 cursor-pointer">
              Corporate Profile
              <ArrowRight size={16} class="group-hover:translate-x-1 transition-transform" />
            </button>
          </a>
          
          <div class="flex flex-col border-l-4 border-green-100 pl-6 py-1">
            <span class="text-[9px] font-black text-[#052c17] uppercase tracking-[0.3em] mb-1">B2B Standard</span>
            <span class="text-slate-600 text-[11px] font-black">Resmi Beroperasi Sejak 2019</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* 1. STATE AWAL: Hidden hanya jika Browser mendukung JS */
  @media (prefers-reduced-motion: no-preference) {
    :global(.js-enabled) .reveal-up,
    :global(.js-enabled) .reveal-left {
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }
    :global(.js-enabled) .reveal-up { transform: translateY(30px); }
    :global(.js-enabled) .reveal-left { transform: translateX(-30px); }
  }

  /* 2. STATE AKTIF */
  :global(.is-visible) .reveal-up,
  :global(.is-visible) .reveal-left,
  :global(.is-visible).reveal-up,
  :global(.is-visible).reveal-left {
    opacity: 1 !important;
    transform: translate(0) !important;
  }
</style>

<script>
  // Tambahkan class js-enabled ke body untuk memicu animasi
  document.documentElement.classList.add('js-enabled');

  const observeElements = () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          // Berhenti mengamati setelah elemen muncul (opsional)
          // observer.unobserve(entry.target); 
        }
      });
    }, { 
      threshold: 0.05, // Dipicu lebih awal agar tidak telat muncul
      rootMargin: '0px 0px -50px 0px' 
    });

    // Amati container utama DAN setiap elemen reveal-up secara individual
    document.querySelectorAll('.reveal-container, .reveal-up, .reveal-left').forEach(el => {
      observer.observe(el);
    });
  };

  // Jalankan saat DOM siap dan saat navigasi Astro (jika pakai View Transitions)
  observeElements();
  document.addEventListener('astro:after-swap', observeElements);
</script>