---
/**
 * DISTRICT TARGET - ASTRO VERSION (SEO Optimized)
 * Strategi: Zero Hydration untuk Kejelasan Segmen Pasar bagi Googlebot.
 */
import { 
  ArrowUpRight, Building, Coffee, Utensils, 
  Hotel, Home, Store, Users, Briefcase 
} from 'lucide-react';

const { district } = Astro.props;

// Fungsi helper untuk mendapatkan ikon di sisi server (Build Time)
const getIconInfo = (clientType: string, index: number) => {
  const type = clientType.toLowerCase();
  if (type.includes('restoran') || type.includes('dining')) return Utensils;
  if (type.includes('cafe') || type.includes('coffee')) return Coffee;
  if (type.includes('hotel')) return Hotel;
  if (type.includes('warung') || type.includes('rumah makan')) return Home;
  if (type.includes('mall') || type.includes('store')) return Store;
  if (type.includes('catering') || type.includes('corporate') || type.includes('office')) return Briefcase;
  
  const defaultIcons = [Building, Coffee, Utensils, Hotel, Home, Store, Users, Briefcase];
  return defaultIcons[index % defaultIcons.length];
};

const colorVariants = [
  { bg: 'bg-blue-50', text: 'text-blue-700', border: 'border-blue-100', accent: 'bg-blue-700' },
  { bg: 'bg-green-50', text: 'text-green-700', border: 'border-green-100', accent: 'bg-green-700' },
  { bg: 'bg-purple-50', text: 'text-purple-700', border: 'border-purple-100', accent: 'bg-purple-700' },
  { bg: 'bg-orange-50', text: 'text-orange-700', border: 'border-orange-100', accent: 'bg-orange-700' },
  { bg: 'bg-rose-50', text: 'text-rose-700', border: 'border-rose-100', accent: 'bg-rose-700' },
  { bg: 'bg-cyan-50', text: 'text-cyan-700', border: 'border-cyan-100', accent: 'bg-cyan-700' }
];

const clients = district?.clientFocus?.split(', ') || [];
---

<section class="py-12 md:py-16 lg:py-20 bg-white font-sans text-left reveal-container">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <div class="mb-12 md:mb-16 text-center">
      <div class="space-y-4">
        <div class="inline-flex items-center gap-3 px-4 py-2 bg-green-50 border border-green-200 rounded-full reveal-up">
          <div class="w-2 h-2 rounded-full bg-[#15803d] animate-pulse"></div>
          <span class="text-[11px] font-black uppercase tracking-[0.3em] text-[#15803d]">Client Segments</span>
        </div>
        
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-[1000] text-[#052c17] tracking-tighter leading-tight uppercase reveal-up">
          Spesialisasi <span class="text-[#15803d]">Layanan.</span>
        </h2>
        
        <p class="text-base md:text-lg text-slate-600 max-w-2xl mx-auto font-medium reveal-up" style="transition-delay: 0.1s;">
          Fokus melayani berbagai segmen bisnis kuliner di <span class="font-bold text-[#052c17]">{district?.name || 'wilayah jangkauan'}</span>
        </p>
      </div>
    </div>

    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
      {clients.map((client, index) => {
        const colors = colorVariants[index % colorVariants.length];
        const IconComponent = getIconInfo(client, index);

        return (
          <div
            class={`group relative rounded-xl md:rounded-3xl transition-all duration-500 bg-white border ${colors.border} shadow-sm hover:shadow-xl hover:-translate-y-1 overflow-hidden flex flex-col reveal-up`}
            style={`transition-delay: ${index * 0.05}s;`}
          >
            <div class="p-5 md:p-8 flex flex-col flex-1 relative z-10">
              <div class="flex items-start justify-between mb-6">
                <div class={`p-3 rounded-xl md:rounded-2xl ${colors.bg} ${colors.text} group-hover:bg-[#052c17] group-hover:text-white transition-all duration-300`}>
                  <IconComponent size={24} />
                </div>
                <span class="text-2xl md:text-4xl font-black text-slate-100 group-hover:text-slate-50 transition-colors">
                  0{index + 1}
                </span>
              </div>

              <div class="space-y-3 flex-1">
                <h3 class="text-sm md:text-lg font-black leading-tight text-[#052c17] uppercase group-hover:text-[#15803d] transition-colors">
                  {client}
                </h3>
                
                <div class={`h-1 w-8 rounded-full ${colors.accent}`} />
                
                <p class="text-xs md:text-sm leading-relaxed font-medium text-slate-600">
                  {`Supply chain khusus untuk pengadaan komoditas ${client.toLowerCase()} skala B2B.`}
                </p>
              </div>

              <div class="mt-6 pt-4 border-t border-slate-100 flex items-center justify-between">
                <span class={`text-[9px] md:text-[10px] font-black uppercase tracking-widest ${colors.text}`}>
                  Expert Support
                </span>
                <ArrowUpRight size={18} class="text-slate-400 group-hover:text-[#15803d] group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-all" />
              </div>
            </div>
          </div>
        );
      })}
    </div>

    <div class="mt-12 md:mt-20 p-6 bg-slate-50 border border-slate-200 rounded-3xl reveal-up" style="transition-delay: 0.4s;">
      <div class="flex flex-col sm:flex-row items-center justify-center gap-8 md:gap-16">
        <div class="text-center">
          <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Total Segments</p>
          <p class="text-3xl font-black text-[#15803d]">{clients.length}</p>
        </div>
        <div class="hidden sm:block h-10 w-px bg-slate-200"></div>
        <div class="text-center">
          <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Service Tier</p>
          <p class="text-3xl font-black text-[#052c17]">Enterprise</p>
        </div>
        <div class="hidden sm:block h-10 w-px bg-slate-200"></div>
        <div class="text-center">
          <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Active Area</p>
          <p class="text-xl font-bold text-slate-700">{district?.name}</p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Animasi CSS Murni (SEO Friendly) */
  .reveal-container .reveal-up {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
  }

  :global(.is-visible) .reveal-up {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
  /**
   * Intersection Observer ringan untuk memicu animasi visual.
   * Teks segmen pasar tetap terbaca oleh bot sejak awal.
   */
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
      }
    });
  }, { threshold: 0.1 });

  document.querySelectorAll('.reveal-container, .reveal-up').forEach(el => observer.observe(el));
</script>