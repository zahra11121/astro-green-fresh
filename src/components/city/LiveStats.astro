---
/**
 * LIVE STATS - GOJEK STYLE (Super-App Compact)
 * Fokus: Mengecilkan semua elemen agar pas di layar HP tanpa terasa penuh.
 */
import { Zap, MapPin, Clock, CheckCircle } from 'lucide-react';

const stats = [
  { label: "Kapasitas", value: "2.5", unit: "TON", icon: Zap },
  { label: "Distribusi", value: "45", unit: "TITIK", icon: MapPin },
  { label: "Waktu", value: "4", unit: "JAM", icon: Clock },
  { label: "Akurasi", value: "99", unit: "%", icon: CheckCircle },
];
---

<section class="bg-white border-y border-slate-100 font-sans reveal-container overflow-hidden"> 
  <div class="max-w-[1200px] mx-auto">
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-px bg-slate-100">
      {stats.map((stat, i) => {
        const StatIcon = stat.icon;
        
        return (
          <div 
            class="relative p-4 md:p-12 lg:p-16 flex items-center md:flex-col md:text-center gap-3 bg-white reveal-up"
            style={`transition-delay: ${i * 0.1}s;`}
          >
            <div class="shrink-0 w-10 h-10 md:w-14 md:h-14 rounded-full bg-green-50 flex items-center justify-center text-[#15803d]">
              <StatIcon size={18} class="md:w-6 md:h-6" strokeWidth={2.5} />
            </div>

            <div class="flex flex-col md:items-center min-w-0">
              <div class="flex items-baseline gap-1">
                <span class="text-xl md:text-5xl lg:text-6xl font-black tracking-tight text-[#052c17] leading-none"> 
                  {stat.value}
                </span>
                <span class="text-[9px] md:text-sm font-bold text-[#15803d] uppercase tracking-tighter">
                  {stat.unit}
                </span>
              </div>
              
              <p class="text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-wide truncate">
                {stat.label}
              </p>
            </div>
          </div>
        );
      })}
    </div>
  </div>
</section>

<style>
  .reveal-container .reveal-up {
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }

  :global(.is-visible) .reveal-up {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
</style>

<script>
  const setupStatsObserver = () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.reveal-up').forEach(el => observer.observe(el));
  };

  setupStatsObserver();
  document.addEventListener('astro:after-swap', setupStatsObserver);
</script>